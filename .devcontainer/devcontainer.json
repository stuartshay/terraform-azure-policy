{
    "name": "Azure Policy Development",
    "image": "mcr.microsoft.com/devcontainers/base:ubuntu",
    "features": {
        "ghcr.io/devcontainers/features/azure-cli:1": {
            "version": "latest",
            "extensions": "account,resource-graph"
        },
        "ghcr.io/devcontainers/features/terraform:1": {
            "version": "1.13.1",
            "tflint": "latest",
            "terragrunt": "none"
        },
        "ghcr.io/devcontainers/features/powershell:1": {
            "version": "latest"
        },
        "ghcr.io/devcontainers/features/python:1": {
            "version": "3.11",
            "installTools": true
        },
        "ghcr.io/devcontainers/features/git:1": {
            "version": "latest",
            "ppa": true
        },
        "ghcr.io/devcontainers/features/github-cli:1": {
            "version": "latest"
        },
        "ghcr.io/devcontainers/features/node:1": {
            "version": "lts",
            "nodeGypDependencies": true
        }
    },
    "customizations": {
        "vscode": {
            "extensions": [
                "ms-vscode.powershell",
                "hashicorp.terraform",
                "ms-vscode.azure-account",
                "ms-azuretools.vscode-azureresourcegroups",
                "redhat.vscode-yaml",
                "ms-vscode.vscode-json",
                "GitHub.vscode-pull-request-github",
                "eamodio.gitlens",
                "DavidAnson.vscode-markdownlint",
                "yzhang.markdown-all-in-one",
                "streetsidesoftware.code-spell-checker",
                "timonwong.shellcheck",
                "foxundermoon.shell-format",
                "redhat.vscode-xml"
            ],
            "settings": {
                "terminal.integrated.defaultProfile.linux": "pwsh",
                "terminal.integrated.profiles.linux": {
                    "pwsh": {
                        "path": "/opt/microsoft/powershell/7/pwsh",
                        "icon": "terminal-powershell"
                    },
                    "bash": {
                        "path": "/bin/bash",
                        "icon": "terminal-bash"
                    }
                },
                "powershell.powerShellDefaultVersion": "PowerShell (x64)",
                "powershell.scriptAnalysis.enable": true,
                "powershell.codeFormatting.preset": "OTBS",
                "terraform.languageServer.enable": true,
                "terraform.experimentalFeatures.validateOnSave": true,
                "files.associations": {
                    "*.tf": "terraform",
                    "*.tfvars": "terraform",
                    "*.hcl": "terraform"
                },
                "files.insertFinalNewline": true,
                "files.trimTrailingWhitespace": true,
                "editor.formatOnSave": true,
                "editor.rulers": [
                    120
                ]
            }
        }
    },
    "forwardPorts": [],
    "postCreateCommand": "bash .devcontainer/setup.sh",
    "onCreateCommand": "echo 'Container created at: $(date)'",
    "remoteUser": "vscode",
    "mounts": [],
    "initializeCommand": "echo 'Initializing devcontainer...'",
    "containerEnv": {
        "TF_IN_AUTOMATION": "1",
        "TF_INPUT": "0",
        "DEBIAN_FRONTEND": "noninteractive"
    },
    "runArgs": [
        "--name=azure-policy-devcontainer"
    ]
}
